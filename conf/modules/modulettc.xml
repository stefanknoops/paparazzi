<!DOCTYPE module SYSTEM "module.dtd">

<module name="modulettc">
  <doc>
    <description>Calculates the time to contact from farneback optical flow vectors</description>
  </doc>

  <settings>
    <dl_settings>
      <dl_settings name="LinearFlowFit">
         <dl_setting var="n_iterations" min="1" step="1" max="255" shortname="n_itts"/>
	 <dl_setting var="error_threshold" min="1" step="1" max="50" shortname="err_th"/>
	 <dl_setting var="n_samples" min="3" step="1" max="1000" shortname="n_samp"/>
      </dl_settings>
    </dl_settings>
  </settings>

  <settings>
    <dl_settings>
      <dl_settings name="SmoothingFunction">
         <dl_setting var="degree_of_decrease" min="0" step="0.05" max="1" shortname="alpha"/>
      </dl_settings>
    </dl_settings>
  </settings>

  <header>
    <file name="modulettc.h"/>
  </header>
  <init fun="ttc_init()"/>
  <periodic fun="ttc_periodic()" freq="20" autorun="TRUE"/>
  <makefile target="nps">
    <file name="modulettc.c"/>
    <file name="Farneback_calculator.cpp" dir="modules/farneback_avoider"/>
    <file name="linear_flow_fit.c" dir="modules/computer_vision/opticflow"/>
    <file name="pprz_algebra_float.c" dir="math"/>
    <file name="pprz_matrix_decomp_float.c" dir="math"/>
		<flag name="CFLAGS" value="I$(PAPARAZZI_SRC)/sw/ext/opencv_bebop/install_pc/include"/>
		    <flag name="LDFLAGS" value="L$(PAPARAZZI_HOME)/sw/ext/opencv_bebop/install_pc/lib"/>
			<flag name="LDFLAGS" value="lopencv_world"/>
			<flag name="LDFLAGS" value="L$(PAPARAZZI_HOME)/sw/ext/opencv_bebop/install_pc/share/OpenCV/3rdparty/lib"/>
			<flag name="LDFLAGS" value="llibprotobuf"/>
			<flag name="LDFLAGS" value="lquirc"/>
			<flag name="LDFLAGS" value="L/usr/lib/x86_64-linux-gnu"/>
			<flag name="LDFLAGS" value="ljpeg"/>
			<flag name="LDFLAGS" value="lpng"/>
			<flag name="LDFLAGS" value="ltiff"/>
			<flag name="LDFLAGS" value="lz"/>
			<flag name="LDFLAGS" value="ldl"/>
			<flag name="LDFLAGS" value="lm"/>
			<flag name="LDFLAGS" value="lpthread"/>
			<flag name="LDFLAGS" value="lrt"/> 
  </makefile>
</module>

